(this["webpackJsonpspotify-app"]=this["webpackJsonpspotify-app"]||[]).push([[0],{317:function(e,t,a){},319:function(e){e.exports=JSON.parse('{"particles":{"number":{"value":170,"density":{"enable":true,"value_area":400}},"color":{"value":"#ffffff"},"shape":{"type":"circle","stroke":{"width":0,"color":"#000000"},"polygon":{"nb_sides":5},"image":{"src":"img/github.svg","width":100,"height":100}},"opacity":{"value":1,"random":true,"anim":{"enable":true,"speed":1,"opacity_min":0,"sync":false}},"size":{"value":3,"random":true,"anim":{"enable":false,"speed":4,"size_min":0.3,"sync":false}},"line_linked":{"enable":false,"distance":150,"color":"#ffffff","opacity":0.4,"width":1},"move":{"enable":true,"speed":1,"direction":"none","random":true,"straight":false,"out_mode":"out","bounce":false,"attract":{"enable":false,"rotateX":600,"rotateY":600}}},"interactivity":{"detect_on":"canvas","events":{"onhover":{"enable":false,"mode":"bubble"},"onclick":{"enable":false,"mode":"repulse"},"resize":true},"modes":{"grab":{"distance":400,"line_linked":{"opacity":1}},"bubble":{"distance":250,"size":0,"duration":2,"opacity":0,"speed":3},"repulse":{"distance":400,"duration":0.4},"push":{"particles_nb":4},"remove":{"particles_nb":2}}},"retina_detect":true}')},320:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(5),s=a.n(c),r=a(74),i=a.n(r),o=(a(81),a(10)),l=a.n(o),u=a(21),d=a(14),b=function(e){var t=e.id,a=e.name,c=e.image,s=e.popularity,r=e.getAlbumTracks;return Object(n.jsxs)("div",{onClick:function(){r(t)},className:"grow br2 ba dark-gray b--black-10 mv2 mv4-ns w-50 ma3-ns w-20-ns center",children:[Object(n.jsx)("img",{src:c,className:"db w-100 br2 br--top",alt:"Album art"}),Object(n.jsx)("div",{className:"pa2 ph3-ns pb3-ns",children:Object(n.jsxs)("div",{className:"dt w-100 mt1",children:[Object(n.jsx)("div",{className:"dtc w-90",children:Object(n.jsx)("h1",{className:"f5 f4-ns mv0 white",children:a})}),Object(n.jsx)("div",{className:"dtc tr w-10",children:Object(n.jsx)("h2",{className:"f5 mv0 popularity",children:s})})]})})]})},m=(a(83),function(e){var t=e.userAlbums,a=e.getAlbumTracks;Object(c.useEffect)((function(){console.log("useeffect ran on album list"),t&&s()}));var s=function(){for(var e=document.getElementsByClassName("popularity"),t=0;t<e.length;t++){var a=Number(e[t].innerHTML);e[t].style.color=a>=75?"green":a>=25?"darkorange":"red"}};return t?Object(n.jsx)("div",{className:"album-list animate",style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:t.map((function(e){return Object(n.jsx)(b,{id:e.id,name:e.name,image:e.image,popularity:e.popularity,getAlbumTracks:a},e.id)}))}):null}),p=function(e){var t=e.clientId,a=e.redirect;return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)("button",{style:{margin:"10%"},onClick:function(){return window.location.replace("https://accounts.spotify.com/authorize?client_id=".concat(t,"&response_type=code&redirect_uri=").concat(a,"&show_dialog=false&scope=user-read-private%20user-library-read"))},children:"Connect to Spotify!"})})},f=(a(84),function(e){e.userProfileUrl;var t=e.userDisplayName;return Object(n.jsx)("div",{className:"welcome",children:Object(n.jsxs)("h1",{className:"fade-in",children:["Welcome, ",t,".",Object(n.jsx)("br",{})]})})}),j=(a(85),function(e){var t=e.loadedAlbum,a=e.clearAlbum;return Object(n.jsxs)("div",{className:"album-tracks",children:[Object(n.jsx)("div",{className:"track text-center grow",onClick:a,children:"BACK"}),t.map((function(e){return Object(n.jsxs)("div",{className:"track text-center grow",children:[e.name,"  ",Object(n.jsx)("br",{})]},e.id)}))]})}),h=a(75),v=a.n(h),y=(a(317),a(318),"ebcbc13ca3b34ed6a4cf0bf4d7579df9"),O="https%3A%2F%2Fwww.jamescockayne.co.uk%2Fspotify-app%2F",x=function(){var e=Object(c.useState)(null),t=Object(d.a)(e,2),s=t[0],r=t[1],i=Object(c.useState)(null),o=Object(d.a)(i,2),b=o[0],h=o[1],x=Object(c.useState)(null),g=Object(d.a)(x,2),w=(g[0],g[1]),k=Object(c.useState)(null),N=Object(d.a)(k,2),_=(N[0],N[1]),A=Object(c.useState)(null),S=Object(d.a)(A,2),T=(S[0],S[1]),C=Object(c.useState)("Loading..."),E=Object(d.a)(C,2),B=E[0],z=E[1],L=Object(c.useState)(null),P=Object(d.a)(L,2),F=(P[0],P[1]),I=Object(c.useState)(null),J=Object(d.a)(I,2),D=J[0],U=J[1],M=Object(c.useState)(null),W=Object(d.a)(M,2),G=W[0],H=W[1],K=Object(c.useState)([]),R=Object(d.a)(K,2),X=R[0],Y=R[1],q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}},Q=a(319);Object(c.useEffect)((function(){""!==window.location.search?V():console.log("Please link with Spotify")}),[]);var V=function(){var e=new URLSearchParams(window.location.search).get("code");r(e),Z(e)},Z=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://spotify-test-project.herokuapp.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t,clientId:y,redirect:O})});case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent;try{T(new Date),_(n.expires_in),h(n.access_token),w(n.refresh_token),$(n.access_token)}catch(c){console.log(c)}case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.spotify.com/v1/me",q(t));case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,z(n.display_name),F(n.product),U(n.external_urls.spotify),ee(t),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=0;case 2:if(a.length%50!==0){e.next=15;break}return e.next=5,fetch("https://api.spotify.com/v1/me/albums?offset=".concat(n,"&limit=50"),q(t));case 5:return c=e.sent,e.next=8,c.json();case 8:if(0!==(s=e.sent).items.length){e.next=11;break}return e.abrupt("break",15);case 11:a=a.concat(s.items),n+=50,e.next=2;break;case 15:te(a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e){var t=e.map((function(e){return{name:e.album.name,image:e.album.images[0].url,popularity:e.album.popularity,id:e.album.id}}));H(t)},ae=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("running getAlbumTracks()"),e.next=3,fetch("https://api.spotify.com/v1/albums/".concat(t,"/tracks"),q());case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,c=n.items.map((function(e){return{name:e.name,length:e.duration_ms,id:e.id,link:e.external_urls.spotify}})),Y(c),document.getElementsByTagName("body")[0].style.overflow="hidden",document.getElementsByClassName("overlay")[0].classList.add("show");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{children:[Object(n.jsx)(v.a,{params:Q,className:"particles"}),null===s?Object(n.jsx)(p,{clientId:y,redirect:O}):Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("div",{className:"overlay hide",children:Object(n.jsx)(j,{loadedAlbum:X,clearAlbum:function(){document.getElementsByTagName("body")[0].style.overflow="visible",document.getElementsByClassName("overlay")[0].classList.remove("show")}})}),Object(n.jsx)(f,{userDisplayName:B,userProfileUrl:D}),Object(n.jsx)(m,{userAlbums:G,getAlbumTracks:ae})]})]})};i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(x,{})}),document.getElementById("root"))},81:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){}},[[320,1,2]]]);
//# sourceMappingURL=main.b42b706e.chunk.js.map