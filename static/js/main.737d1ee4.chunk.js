(this["webpackJsonpspotify-app"]=this["webpackJsonpspotify-app"]||[]).push([[0],{197:function(e,t,n){},198:function(e,t,n){},199:function(e,t,n){},200:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){},365:function(e,t,n){},367:function(e){e.exports=JSON.parse('{"particles":{"number":{"value":50,"density":{"enable":true,"value_area":400}},"color":{"value":"#ffffff"},"shape":{"type":"circle","stroke":{"width":0,"color":"#000000"},"polygon":{"nb_sides":5},"image":{"src":"img/github.svg","width":100,"height":100}},"opacity":{"value":1,"random":true,"anim":{"enable":true,"speed":1,"opacity_min":0,"sync":false}},"size":{"value":3,"random":true,"anim":{"enable":false,"speed":4,"size_min":0.3,"sync":false}},"line_linked":{"enable":false,"distance":150,"color":"#ffffff","opacity":0.4,"width":1},"move":{"enable":true,"speed":1,"direction":"none","random":true,"straight":false,"out_mode":"out","bounce":false,"attract":{"enable":false,"rotateX":600,"rotateY":600}}},"interactivity":{"detect_on":"canvas","events":{"onhover":{"enable":false,"mode":"bubble"},"onclick":{"enable":false,"mode":"repulse"},"resize":true},"modes":{"grab":{"distance":400,"line_linked":{"opacity":1}},"bubble":{"distance":250,"size":0,"duration":2,"opacity":0,"speed":3},"repulse":{"distance":400,"duration":0.4},"push":{"particles_nb":4},"remove":{"particles_nb":2}}},"retina_detect":true}')},368:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(5),s=n.n(c),r=n(89),i=n.n(r),o=(n(96),n(9)),l=n.n(o),u=n(22),d=n(17),m=(n(98),function(e){var t=e.clientId,n=e.redirect;return Object(a.jsx)("div",{className:"splash",children:Object(a.jsx)("div",{className:"btn grow",onClick:function(){return window.location.replace("https://accounts.spotify.com/authorize?client_id=".concat(t,"&response_type=code&redirect_uri=").concat(n,"&show_dialog=true&scope=user-read-private%20user-library-read"))},children:"Connect to Spotify!"})})}),b=n(25),p=(n(197),function(e){var t=e.loadedSong,n=e.clearSong,c=Math.floor(t.duration_ms/1e3/60),s=Math.round(t.duration_ms/1e3%60);1===s.toString().length&&(s="0".concat(s));var r=window.innerWidth<500,i=t.valence>.5,o=t.acousticness>.4,l=t.danceability>.45,u=t.energy>.4,d=t.instrumentalness>.5,m=t.liveness>.4,p=t.speechiness>.33,f="rgba(0, 255, 0, 0.2)",j="rgba(0, 255, 0, 1)",h="rgba(255, 84, 84, 0.2)",v="rgba(255, 84, 84, 1)",g={labels:["Acousticness","Danceability","Valence","Instrumentalness","Energy","Liveness","Speechiness"],datasets:[{data:[t.acousticness,t.danceability,t.valence,t.instrumentalness,t.energy,t.liveness,t.speechiness],backgroundColor:["".concat(o?f:h),"".concat(l?f:h),"".concat(i?f:h),"".concat(d?f:h),"".concat(u?f:h),"".concat(m?f:h),"".concat(p?f:h)],borderColor:["".concat(o?j:v),"".concat(l?j:v),"".concat(i?j:v),"".concat(d?j:v),"".concat(u?j:v),"".concat(m?j:v),"".concat(p?j:v)],borderWidth:1}]};return Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{className:"title",children:t.name}),Object(a.jsx)("p",{className:"length",children:"(".concat(c,":").concat(s,")")}),Object(a.jsx)("div",{className:"chart",children:r?Object(a.jsx)(b.Bar,{data:g,options:{scales:{yAxes:[{ticks:{display:!1,beginAtZero:!0,min:0,max:1}}],xAxes:[{ticks:{display:!0,fontColor:"white",beginAtZero:!0,min:0,max:1}}]}}}):Object(a.jsx)(b.HorizontalBar,{data:g,options:{scales:{yAxes:[{ticks:{display:!0,fontColor:"white",beginAtZero:!0,min:0,max:1}}],xAxes:[{ticks:{display:!1,beginAtZero:!0,min:0,max:1}}]}}})}),Object(a.jsx)("div",{id:"back-button",className:"title grow ".concat(r?"btn-view-small":"btn-view"),style:{cursor:"pointer"},onClick:n,children:"BACK"})]})}),f=(n(198),function(e){var t=e.loadedAlbum,n=e.clearAlbum,c=e.getSongInfo;return Object(a.jsxs)("div",{className:"album-tracks",children:[Object(a.jsx)("div",{className:"back-btn-to-lib track text-center grow",onClick:n,children:"BACK"}),t.map((function(e){return Object(a.jsxs)("div",{onClick:function(){c(e.id,e.name)},className:"track text-center grow",children:[e.name,"  ",Object(a.jsx)("br",{})]},e.id)}))]})}),j=(n(199),function(e){var t=e.isSongLoaded,n=e.loadedSong,c=e.loadedAlbum,s=e.getSongInfo,r=e.clearAlbum,i=e.clearSong;return Object(a.jsx)("div",{className:"overlay hide",children:t?Object(a.jsx)(p,{loadedSong:n,clearSong:i}):Object(a.jsx)(f,{loadedAlbum:c,getSongInfo:s,clearAlbum:r})})}),h=(n(200),function(e){e.userProfileUrl;var t=e.userDisplayName;return Object(a.jsx)("div",{className:"welcome",children:Object(a.jsxs)("h1",{id:"welcome-text",className:"hide-welcome",children:["Welcome, ",t,".",Object(a.jsx)("br",{})]})})}),v=(n(201),function(e){var t=e.id,n=e.name,c=e.image,s=e.popularity,r=e.getAlbumTracks;return Object(a.jsxs)("div",{onClick:function(){r(t)},className:"grow br2 ba dark-gray b--black-10 mv2 mv4-ns w-50 ma3-ns w-20-ns center card",children:[Object(a.jsx)("img",{src:c,className:"db w-100 br2 br--top image",alt:"Album art"}),Object(a.jsx)("div",{className:"pa2 ph3-ns pb3-ns background ",children:Object(a.jsxs)("div",{className:"dt w-100 mt1 ",children:[Object(a.jsx)("div",{className:"dtc w-90 ",children:Object(a.jsx)("h1",{className:"f5 f4-ns mv0 white",children:n})}),Object(a.jsx)("div",{className:"dtc tr w-10",children:Object(a.jsx)("h2",{className:"f5 mv0 popularity",children:s})})]})})]})}),g=(n(202),function(e){var t=e.userAlbums,n=e.getAlbumTracks;Object(c.useEffect)((function(){t&&s()}));var s=function(){for(var e=document.getElementsByClassName("popularity"),t=0;t<e.length;t++){var n=Number(e[t].innerHTML);e[t].style.color=n>=75?"green":n>=25?"darkorange":"red"}};return t?Object(a.jsx)("div",{className:"album-list animate",style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:t.map((function(e){return Object(a.jsx)(v,{id:e.id,name:e.name,image:e.image,popularity:e.popularity,getAlbumTracks:n},e.id)}))}):null}),y=function(e){var t=e.userDisplayName,n=e.userProfileUrl,c=e.userAlbums,s=e.getAlbumTracks;return Object(a.jsxs)("div",{className:"library-view",children:[Object(a.jsx)(h,{userDisplayName:t,userProfileUrl:n}),Object(a.jsx)(g,{userAlbums:c,getAlbumTracks:s})]})},x=n(90),O=n.n(x);n(365),n(366);b.Chart.defaults.global.legend.display=!1;var w="ebcbc13ca3b34ed6a4cf0bf4d7579df9",k="https%3A%2F%2Fwww.jamescockayne.co.uk%2Fspotify-app%2F",N=function(){var e=Object(c.useState)(null),t=Object(d.a)(e,2),s=t[0],r=t[1],i=Object(c.useState)(null),o=Object(d.a)(i,2),b=o[0],p=o[1],f=Object(c.useState)("Loading..."),h=Object(d.a)(f,2),v=h[0],g=h[1],x=Object(c.useState)(null),N=Object(d.a)(x,2),A=N[0],S=N[1],_=Object(c.useState)(null),C=Object(d.a)(_,2),B=C[0],E=C[1],T=Object(c.useState)([]),I=Object(d.a)(T,2),L=I[0],z=I[1],P=Object(c.useState)(!1),D=Object(d.a)(P,2),U=D[0],F=D[1],J=Object(c.useState)({}),M=Object(d.a)(J,2),W=M[0],Z=M[1],H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}},K=n(367);Object(c.useEffect)((function(){""!==window.location.search?G():console.log("Please link with Spotify")}),[]);var G=function(){var e=new URLSearchParams(window.location.search).get("code");r(e),R(e)},R=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://spotify-test-project.herokuapp.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t,clientId:w,redirect:k})});case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent;try{p(a.access_token),V(a.access_token)}catch(c){console.log(c)}case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.spotify.com/v1/me",H(t));case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,g(a.display_name),S(a.external_urls.spotify),document.getElementById("welcome-text").classList.remove("hide-welcome"),document.getElementById("welcome-text").classList.add("fade-in"),X(t),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0;case 2:if(n.length%50!==0){e.next=15;break}return e.next=5,fetch("https://api.spotify.com/v1/me/albums?offset=".concat(a,"&limit=50"),H(t));case 5:return c=e.sent,e.next=8,c.json();case 8:if(0!==(s=e.sent).items.length){e.next=11;break}return e.abrupt("break",15);case 11:n=n.concat(s.items),a+=50,e.next=2;break;case 15:Y(n);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){var t=e.map((function(e){return{name:e.album.name,image:e.album.images[0].url,popularity:e.album.popularity,id:e.album.id}}));E(t)},q=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.spotify.com/v1/audio-features/".concat(t),H());case 2:return a=e.sent,e.next=5,a.json();case 5:(c=e.sent).name=n,Z(c),F(!0);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementsByTagName("html")[0].style.overflow="hidden",e.next=3,fetch("https://api.spotify.com/v1/albums/".concat(t,"/tracks"),H());case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,c=a.items.map((function(e){return{name:e.name,length:e.duration_ms,id:e.id,link:e.external_urls.spotify}})),z(c),document.getElementsByClassName("overlay")[0].classList.add("show");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(O.a,{params:K,className:"particles"}),null===s?Object(a.jsx)(m,{clientId:w,redirect:k}):Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(j,{isSongLoaded:U,loadedSong:W,loadedAlbum:L,getSongInfo:q,clearAlbum:function(){document.getElementsByClassName("overlay")[0].classList.remove("show"),document.getElementsByTagName("html")[0].style.overflow="visible"},clearSong:function(){F(!1)}}),Object(a.jsx)(y,{userDisplayName:v,userProfileUrl:A,userAlbums:B,getAlbumTracks:Q})]})]})};i.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(N,{})}),document.getElementById("root"))},96:function(e,t,n){},98:function(e,t,n){}},[[368,1,2]]]);
//# sourceMappingURL=main.737d1ee4.chunk.js.map