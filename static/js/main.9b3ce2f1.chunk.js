(this["webpackJsonpspotify-app"]=this["webpackJsonpspotify-app"]||[]).push([[0],{12:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(1),r=n.n(a),s=n(6),i=n.n(s),o=(n(12),n(3)),u=n.n(o),l=n(4),b=n(2),p=function(e){var t=e.id,n=e.name,a=e.image,r=e.popularity,s=e.getAlbumTracks;return Object(c.jsxs)("div",{onClick:function(){s(t)},className:"br2 ba dark-gray b--black-10 mv2 mv4-ns w-50 ma3-ns w-20-ns center",children:[Object(c.jsx)("img",{src:a,className:"db w-100 br2 br--top",alt:"Album art"}),Object(c.jsx)("div",{className:"pa2 ph3-ns pb3-ns",children:Object(c.jsxs)("div",{className:"dt w-100 mt1",children:[Object(c.jsx)("div",{className:"dtc w-90",children:Object(c.jsx)("h1",{className:"f5 f4-ns mv0",children:n})}),Object(c.jsx)("div",{className:"dtc tr w-10",children:Object(c.jsx)("h2",{className:"f5 mv0 popularity",children:r})})]})})]})},d=function(e){var t=e.userAlbums,n=e.getAlbumTracks;Object(a.useEffect)((function(){t&&r()}));var r=function(){for(var e=document.getElementsByClassName("popularity"),t=0;t<e.length;t++){var n=Number(e[t].innerHTML);e[t].style.color=n>=75?"green":n>=25?"darkorange":"red"}};return t?Object(c.jsxs)("div",{id:"AlbumList",style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:[t.map((function(e){return Object(c.jsx)(p,{id:e.id,name:e.name,image:e.image,popularity:e.popularity,getAlbumTracks:n},e.id)})),Object(c.jsx)("div",{onLoad:r})]}):null},j=function(e){var t=e.clientId,n=e.redirect;return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)("button",{style:{margin:"10%"},onClick:function(){return window.location.replace("https://accounts.spotify.com/authorize?client_id=".concat(t,"&response_type=code&redirect_uri=").concat(n,"&show_dialog=false&scope=user-read-private%20user-library-read"))},children:"Connect to Spotify!"})})},m=function(e){var t=e.userProfileUrl,n=e.userDisplayName;return Object(c.jsx)("div",{children:Object(c.jsxs)("h1",{children:["Hi there, ",Object(c.jsx)("a",{href:t,children:n}),Object(c.jsx)("br",{})]})})},f=function(e){var t=e.loadedAlbum;return Object(c.jsx)("div",{className:"Album Tracks",children:t.map((function(e){return Object(c.jsxs)("div",{children:["name: ",e.name,", length: ",e.length,"ms, ",Object(c.jsx)("a",{href:e.link,children:"view on spotify"}),Object(c.jsx)("br",{})]},e.id)}))})},h=(n(14),n(15),"ebcbc13ca3b34ed6a4cf0bf4d7579df9"),O="https%3A%2F%2Fwww.jamescockayne.co.uk%2Fspotify-app%2F",x=function(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),i=Object(b.a)(s,2),o=i[0],p=i[1],x=Object(a.useState)(null),v=Object(b.a)(x,2),y=(v[0],v[1]),g=Object(a.useState)(null),k=Object(b.a)(g,2),w=(k[0],k[1]),A=Object(a.useState)(null),S=Object(b.a)(A,2),N=(S[0],S[1]),_=Object(a.useState)("Loading..."),T=Object(b.a)(_,2),C=T[0],E=T[1],L=Object(a.useState)(null),P=Object(b.a)(L,2),F=(P[0],P[1]),I=Object(a.useState)(null),B=Object(b.a)(I,2),D=B[0],J=B[1],U=Object(a.useState)(null),z=Object(b.a)(U,2),G=z[0],H=z[1],M=Object(a.useState)(!1),R=Object(b.a)(M,2),W=R[0],q=R[1],K=Object(a.useState)({}),Q=Object(b.a)(K,2),V=Q[0],X=Q[1],Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}};Object(a.useEffect)((function(){""!==window.location.search?Z():console.log("Please link with Spotify")}),[]);var Z=function(){var e=new URLSearchParams(window.location.search).get("code");r(e),$(e)},$=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://spotify-test-project.herokuapp.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t,clientId:h,redirect:O})});case 2:return n=e.sent,e.next=5,n.json();case 5:c=e.sent;try{N(new Date),w(c.expires_in),p(c.access_token),y(c.refresh_token),ee(c.access_token)}catch(a){console.log(a)}case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.spotify.com/v1/me",Y(t));case 3:return n=e.sent,e.next=6,n.json();case 6:c=e.sent,E(c.display_name),F(c.product),J(c.external_urls.spotify),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=0;case 2:if(t.length%50!==0){e.next=15;break}return e.next=5,fetch("https://api.spotify.com/v1/me/albums?offset=".concat(n,"&limit=50"),Y());case 5:return c=e.sent,e.next=8,c.json();case 8:if(0!==(a=e.sent).items.length){e.next=11;break}return e.abrupt("break",15);case 11:t=t.concat(a.items),n+=50,e.next=2;break;case 15:ne(t);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(e){var t=e.map((function(e){return{name:e.album.name,image:e.album.images[0].url,popularity:e.album.popularity,id:e.album.id}}));H(t)},ce=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("running getAlbumTracks()"),e.next=3,fetch("https://api.spotify.com/v1/albums/".concat(t,"/tracks"),Y());case 3:return n=e.sent,e.next=6,n.json();case 6:c=e.sent,a=c.items.map((function(e){return{name:e.name,length:e.duration_ms,id:e.id,link:e.external_urls.spotify}})),X(a),q(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return null===n?Object(c.jsx)(j,{clientId:h,redirect:O}):W?Object(c.jsx)(f,{loadedAlbum:V}):Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(m,{userDisplayName:C,userProfileUrl:D}),Object(c.jsx)("button",{style:{margin:"3%"},onClick:te,children:"Get Albums!"}),Object(c.jsx)("button",{style:{margin:"3%"},onClick:function(){ce(G[0].id)},children:"get album tracks"}),Object(c.jsx)(d,{userAlbums:G,getAlbumTracks:ce})]})};i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(x,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.9b3ce2f1.chunk.js.map